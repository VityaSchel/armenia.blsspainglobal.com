# Автоматическая проверка статуса заявки на испанскую визу на armenia.blsspainglobal.com

- Автоматическое решение капчи с помощью стороннего платного сервиса
- Парсинг статуса из HTML
- Отсылка уведомлений в Telegram бот

# Использование

Чтобы установить одного из этих ботов, вам понадобятся базовые навыки работы с терминалом и примерно 50-100 рублей для оплаты автоматического решения капч. Автору ни копейки в карман не идет, это все деньги для работников, которые в реальном времени решают капчи.

Так или иначе, боты должны работать на сервере или айпи, не заблокированном BLS. А именно резидентские айпи России, Армении и Испании, также некоторые резидентские европейские айпи. С любых айпи датацентров у вас зайти не получится, как и с любых бесплатных VPN и прокси. Настройка VPN выходит за пределы этого ридми, но он должен работать у вас на уровне системы.

Если вы используете OpenVPN и хотите сделать split-tunelling для домена armenia.blsspainglobal.com, то:
1. Найдите актуальные айпи адреса их серверов с помощью `dig +short armenia.blsspainglobal.com`
2. В конфиге .ovpn добавьте следующие линии между `persist-tun` и `key-direction 1`:
```
route-nopull
route [айпи адрес 1] 255.255.255.255
route [айпи адрес 2] 255.255.255.255
```
Теперь `curl ifconfig.me` должен у вас выдавать внешний айпи вашего сервера, а запросы к armenia.blsspainglobal.com с реалистичным User-Agent должны возвращать http код 200

## Телеграм бот для всех желающих

Эта версия бота позволяет кому угодно добавлять свои заявки и отслеживать их.

1. Скачайте репозиторий [https://github.com/VityaSchel/armenia.blsspainglobal.com/archive/refs/heads/main.zip]
2. Создайте бота в [@botfather](https://t.me/botfather)
3. Скопируйте токен бота
4. Сделайте копию файла .env.example и переименуйте в .env
5. В файле вставьте токен для автоматического решения капч с сайта [Rucaptcha](https://rucaptcha.com/enterpage); следуйте инструкциям под "Бот для трекинга". Вставьте токен бота.
6. Установите [bun.sh](https://bun.sh) — это рантайм-среда для серверного JavaScript
7. Перейдите в папку со скачанным распакованным репозиторием и выполните команду `bun install` в терминале
8. Запустите скрипт с помощью `bun telegram-tracking-bot`

Теперь ваш бот работает и любой желающий может зайти и добавить в отслеживаемые заявки свою

## Селфхостед телеграм-бот с уведомлениями

Эта версия бота проверяет заданные вами заявки и отправляет уведомления в телеграм, каждый раз, когда вы запускаете бота

1. Скачайте репозиторий [https://github.com/VityaSchel/armenia.blsspainglobal.com/archive/refs/heads/main.zip]
2. Создайте бота в [@botfather](https://t.me/botfather)
3. Скопируйте токен бота
4. Сделайте копию файла .env.example и переименуйте в .env
5. В файле вставьте токен для автоматического решения капч с сайта [Rucaptcha](https://rucaptcha.com/enterpage); следуйте инструкциям под "Бот с уведомлениями". Вставьте токен, ID вашего аккаунта телеграм, номера заявок для отслеживания и даты рождения. 
6. Установите [bun.sh](https://bun.sh) — это рантайм-среда для серверного JavaScript
7. Перейдите в папку со скачанным распакованным репозиторием и выполните команду `bun install` в терминале
8. Запускать скрипт можно с помощью `bun telegram-notifications-bot`

Каждый раз когда вы будете запускать программу, она автоматически будет получать статус заявки (заявок) и отправлять вам в телеграм бота. Идея в том, чтобы запускать скрипт автоматически 1 раз в сутки. Это можно сделать, например, с помощью cron:
- Выполните команду `which bun`
- Выполните команду `crontab -e`
- Вставьте `0 0 * * * [результат команды which bun] [путь к распакованному репозиторию]/src/bot-callback.ts`

# Донат

[hloth.dev/donate](https://hloth.dev/donate)

# Лицензия

[MIT](./LICENSE.md)